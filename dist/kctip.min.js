"use strict";!function(){function t(t){a=!0,h=!0}function e(t,e){for(var i=(t.document||t.ownerDocument).querySelectorAll(e),o=i.length;--o>=0&&i.item(o)!==t;);return o>-1}function i(t){var e=t.getBoundingClientRect(),i=window.pageXOffset||document.documentElement.scrollLeft,o=window.pageYOffset||document.documentElement.scrollTop;return{top:e.top+o,left:e.left+i}}function o(t){r=t.clientX,c=t.clientY,s||requestAnimationFrame(n),s=!0}function n(){s=!1;var t=document.documentElement.clientWidth,e=document.documentElement.clientHeight,i=window.pageXOffset||document.documentElement.scrollLeft,o=window.pageYOffset||document.documentElement.scrollTop,n=r+10+i,d=c+25+o;return n+p.w+10>t+i&&(n=t+i-p.w-10),d+p.h+10>e+o&&(d=e+o-p.h-10),p.move(n,d)}var s=!1,r=void 0,c=void 0,d=document.createElement("style");d.innerHTML='#kctip{z-index:100;position:absolute;display:none;top:-1000px;left:-1000px;color:#f2f2f2;background:rgba(32,32,32,.85);font-size:14px;line-height:150%;opacity:0;cursor:default!important;-webkit-transition:opacity .2s ease-out;transition:opacity .2s ease-out;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;-webkit-box-shadow:0 5px 5px rgba(0,0,0,.35);box-shadow:0 5px 5px rgba(0,0,0,.35);max-width:320px}#kctip>.wrapper{display:block;position:relative;z-index:1;border:1px solid rgba(255,255,255,.5);padding:4px 6px}#kctip.mod-blur-backdrop,#kctip.mod-blur-backdrop>.wrapper{background:rgba(32,32,32,.5)}#kctip.on{opacity:1}#kctip.on.mod-blur-backdrop{-webkit-backdrop-filter:blur(7.5px);backdrop-filter:blur(7.5px)}#kctip.show{display:block;will-change:opacity}#kctip:before{position:absolute;width:0;height:0;overflow:hidden;content:"";border:5px solid transparent}#kctip .loading{padding:.25em .75em}#kctip[kctip-indicator-pos=bottom]:before{border-top-color:rgba(255,255,255,.5);left:50%;left:-webkit-calc(50% - 4px);left:calc(50% - 4px);bottom:-10px}#kctip[kctip-indicator-pos=bottom]{-webkit-box-shadow:0 -5px 5px rgba(0,0,0,.35);box-shadow:0 -5px 5px rgba(0,0,0,.35)}#kctip[kctip-indicator-pos=top]:before{border-bottom-color:rgba(255,255,255,.5);left:50%;left:-webkit-calc(50% - 4px);left:calc(50% - 4px);top:-10px}#kctip[kctip-indicator-pos=left]:before{border-right-color:rgba(255,255,255,.5);top:50%;top:-webkit-calc(50% - 4px);top:calc(50% - 4px);left:-10px}#kctip[kctip-indicator-pos=right]:before{border-left-color:rgba(255,255,255,.5);top:50%;top:-webkit-calc(50% - 4px);top:calc(50% - 4px);right:-10px}',document.head.appendChild(d);var a=!1,h=!1;document.addEventListener("touchstart",t),document.addEventListener("pointerenter",function(e){"touch"==e.pointerType?t():(a=!1,h=!1)}),document.addEventListener("mouseover",function(t){h?(h=!1,a=!0):a=!1});var p={pos:"bottom",size_indicator:8,cache:{},filters:[],countdown_fade:250,init:function(){if(this.is_init)return this;this.body=document.createElement("div"),this.body.classList.add("kctip"),this.body.setAttribute("id","kctip");var t=["transitionend","webkitTransitionEnd","mozTransitionEnd"];t.forEach(function(t){this.body.addEventListener(t,function(t){var e=window.getComputedStyle?getComputedStyle(t.target,null):t.target.currentStyle;t.currentTarget==t.target&&"opacity"==t.propertyName&&0==e.opacity&&p.hideAfter()})},this),document.body.appendChild(this.body),this.container=document.createElement("div"),this.container.classList.add("wrapper"),this.body.appendChild(this.container),("backdrop-filter"in document.documentElement.style||"-webkit-backdrop-filter"in document.documentElement.style)&&this.body.addClass("mod-blur-backdrop"),this.is_init=!0},show:function(t,e,i){return a||!t?!1:(clearTimeout(this.timeout_fade),t=t||document.body,this.el=t,i=i||t.getAttribute("kctip-position")||this.pos,e=this.content(e),this.init(),this.body.classList.contains("show")||this.body.classList.add("show"),this.position(e,i),void(this.is_showing=!0))},position:function(t,e){this.body.style.top="",this.body.style.left="",t.nodeType&&1==t.nodeType?this.container.appendChild(t):this.container.innerHTML=t,this.w=this.body.offsetWidth,this.h=this.body.offsetHeight;var i=this["pos_"+e](this.w,this.h);i&&this.move(i.x,i.y)},hide:function(t){function e(){p.body.classList.remove("on"),p.el.removeEventListener(o),p.el=null,p.is_showing=!1,p.pos="bottom"}return this.is_init&&this.is_showing?void("mouse"==this.pos?requestAnimationFrame(e):this.timeout_fade=setTimeout(e,t?0:this.countdown_fade)):!1},hideAfter:function(){this.body.classList.remove("show"),this.body.style.top="",this.body.style.left="",this.body.removeAttribute("kctip-indicator-pos"),this.body.removeAttribute("kctip-indicator-offset-x"),this.body.removeAttribute("kctip-indicator-offset-y"),delete this.curLoading,r=null,c=null},content:function(t,e){e=e||this.el;var i=void 0,o=void 0;if(!t){t=e.getAttribute("href");var n=/\/([a-z]+)\/([0-9]+)/gi.exec(t);n&&n.length>1&&(i=n[1],o=n[2])}return i&&o?(this.cache[i]||(this.cache[i]={}),this.cache[i][o]?this.cache[i][o]:(this.curLoading=i+"::"+o,this.cache.loading||(this.cache.loading=document.createElement("div"),this.cache.loading.classList.add("loading")),this.load(i,o),this.cache.loading)):t},load:function(t,e){this.cache.loading.innerHTML="载入中...";var i=document.createElement("script");i.src="http://fleet.diablohu.com/!/tip/"+t+"/"+e+".js",i.addEventListener("error",function(t){p.cache.loading.innerHTML="发生错误..."}),document.head.appendChild(i)},move:function(t,e){this.body.style.top=e+"px",this.body.style.left=t+"px",this.body.classList.add("on")},get_indicator_size:function(){return this.size_indicator},pos_mouse:function(t,e){this.el.addEventListener("mousemove",o)},pos_bottom:function(t,e){var o=i(this.el),n=o.left+(this.el.offsetWidth-this.body.offsetWidth)/2,s=o.top+this.el.offsetHeight+this.get_indicator_size();return this.body.setAttribute("kctip-indicator-pos","top"),this.checkpos(n,s,t,e)},pos_top:function(t,e){var o=i(this.el),n=o.left+(this.el.offsetWidth-this.body.offsetWidth)/2,s=o.top-e-this.get_indicator_size();return this.body.setAttribute("kctip-indicator-pos","bottom"),this.checkpos(n,s,t,e)},pos_left:function(t,e){var o=i(this.el),n=o.left-t-this.get_indicator_size(),s=o.top+(this.el.offsetHeight-this.body.offsetHeight)/2;return this.body.setAttribute("kctip-indicator-pos","right"),this.checkpos(n,s,t,e)},pos_right:function(t,e){var o=i(this.el),n=o.left+this.el.offsetWidth+this.get_indicator_size(),s=o.top+(this.el.offsetHeight-this.body.offsetHeight)/2;return this.body.setAttribute("kctip-indicator-pos","left"),this.checkpos(n,s,t,e)},checkpos:function(t,e,o,n){var s=i(this.el),r=t,c=e,d={x:r,y:c},a=document.documentElement.clientWidth,h=document.documentElement.clientHeight,p=window.pageXOffset||document.documentElement.scrollLeft,l=window.pageYOffset||document.documentElement.scrollTop;return o=o||this.w,n=n||this.h,t+o>a+p?d=o>s.left?{x:a+p-o-2,y:e}:this.pos_left(o,n):0>t&&(d=this.pos_right(o,n)),e+n>l+h?d=this.pos_top(o,n):l>e&&(d=this.pos_bottom(o,n)),this.body.setAttribute("kctip-indicator-offset-x",t-r+"px"),this.body.setAttribute("kctip-indicator-offset-y",e-c+"px"),d},trigger_by_el:function(t){this.show(t)}},l='[href^="http://fleet.diablohu.com/"], [kctip]',u=document.createEvent("Event"),f=document.createEvent("Event");return u.initEvent("tipshow",!0,!0),f.initEvent("tiphide",!0,!0),document.addEventListener("mouseover",function(t){if(!a)for(var i=t.target;i&&i!=this;i=i.parentNode)if(e(i,l))return p.show(i)},!1),document.addEventListener("mouseout",function(t){for(var i=t.target;i&&i!=this;i=i.parentNode)if(e(i,l))return p.hide()},!1),document.addEventListener("click",function(t){for(var i=t.target;i&&i!=this;i=i.parentNode)if(e(i,l))return p.hide(!0)},!1),document.addEventListener("tipshow",function(t){for(var i=t.target;i&&i!=this;i=i.parentNode)if(e(i,l))return p.trigger_by_el(i)},!1),document.addEventListener("tiphide",function(t){for(var i=t.target;i&&i!=this;i=i.parentNode)if(e(i,l))return p.hide()},!1),p}();